(window.webpackJsonpbirdie=window.webpackJsonpbirdie||[]).push([[0],{22:function(e,t,n){e.exports=n(48)},27:function(e,t,n){},29:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(15),c=n.n(o),l=(n(27),n(3)),i=n.n(l),s=n(5),u=n(1),m=n(16),f=n(17),v=n(20),d=n(18),b=n(21),g=(n(29),n(4)),p=n.n(g),h="http://localhost:3004/api",w=null,E={getAll:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"-1",t=p.a.get(h+"/observations?order="+e);return t.then((function(e){return window.localStorage.setItem("observations",e.data),e.data})).catch((function(e){window.localStorage.getItem("observations")}))},create:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},a=window.localStorage.getItem("observations")||[],window.localStorage.setItem("observations",a.concat(t)),e.next=5,p.a.post(h+"/observations",t,n);case 5:return r=e.sent,e.abrupt("return",r.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return p.a.put("".concat(h,"/observations/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){w="bearer ".concat(e)},remove:function(e){return p.a.delete("".concat(h,"/observations/").concat(e)).then((function(e){return e.data}))},getAllOffline:function(){return window.localStorage.getItem("observations")}},y=n(19),N=n.n(y),O={login:function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("logging in...",t),e.next=3,p.a.post("http://localhost:3004/api/login",t);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),logout:function(){var e=Object(s.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("logging out..."),e.next=3,p.a.post("http://localhost:3004/api/logout");case 3:return t=e.sent,e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),register:function(){var e=Object(s.a)(i.a.mark((function e(t,n,a){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("creating user..."),e.next=3,p.a.post("http://localhost:3004/api/register");case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},S=function(e){var t=e.message;return null===t?null:r.a.createElement("div",{className:"error"},t)},j=function(){return r.a.createElement("div",{style:{color:"green",fontStyle:"italic",fontSize:16}},r.a.createElement("br",null),r.a.createElement("em",null,"Birdie, Elisa Nurmi 2019"))},C=function(e){var t=e.handleSubmit,n=e.handleUsernameChange,a=e.handlePasswordChange,o=e.username,c=e.password;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:t},r.a.createElement("div",null,"Username ",r.a.createElement("input",{value:o,onChange:n})),r.a.createElement("div",null,"Password ",r.a.createElement("input",{type:"password",value:c,onChange:a})),r.a.createElement("button",{type:"submit"},"Login")))},k=function(e){var t=e.onSubmit,n=e.handleNewRarityChange,a=e.handleNewNameChange,o=e.handleNewScientificNameChange,c=e.newName,l=e.newRarity,i=e.newScientificName,s=e.handleNewNoteChange,u=e.newNote;return r.a.createElement("div",null,r.a.createElement("h2",{className:"create-observation-title"},"Create a new observation"),r.a.createElement("form",{onSubmit:t},r.a.createElement("label",null,"Name*"),r.a.createElement("input",{value:c,onChange:a}),r.a.createElement("br",null),r.a.createElement("label",null,"Scientific name"),r.a.createElement("input",{value:i,onChange:o}),r.a.createElement("br",null),r.a.createElement("label",null,"Rarity"),r.a.createElement("select",{value:l,onChange:n},r.a.createElement("option",{value:"common"},"Common"),r.a.createElement("option",{value:"rare"},"Rare"),r.a.createElement("option",{value:"extremely rare"},"Extremely rare")),r.a.createElement("br",null),r.a.createElement("label",null,"Notes",r.a.createElement("br",null),r.a.createElement("textarea",{value:u,onChange:s})),r.a.createElement("br",null),r.a.createElement("button",{type:"submit"},"Save")))},x=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),o=Object(u.a)(n,2),c=o[0],l=o[1],i={display:c?"none":""},s={display:c?"":"none"},m=function(){l(!c)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:m}})),r.a.createElement("div",null,r.a.createElement("div",{style:i},r.a.createElement("button",{onClick:m},e.buttonLabel)),r.a.createElement("div",{style:s},e.children,r.a.createElement("button",{onClick:m},"cancel")))})),R=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(v.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={noteOpen:!1},n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=this.props.observation,n=this.state.noteOpen;return r.a.createElement("div",{key:t.id,className:"observation-row"},r.a.createElement("span",{className:"observation-name"},t.name)," ",r.a.createElement("span",{className:"observation-scientificname"},"(",t.scientificName,")")," ",r.a.createElement("span",{className:"observation-time"},N()(t.datetime).format("HH:MM:SS DD.MM.YYYY")),r.a.createElement("span",{className:"observation-rarity observation-rarity--".concat(t.rarity.split(" ").join("-"))},t.rarity),r.a.createElement("div",{className:"observation-note"},n?r.a.createElement(r.a.Fragment,null,t.note," ",r.a.createElement("button",{onClick:function(){return e.setState({noteOpen:!1})}},"Show less")):r.a.createElement(r.a.Fragment,null,t.note.substring(0,120),"... ",r.a.createElement("button",{onClick:function(){return e.setState({noteOpen:!0})}},"Show more"))))}}]),t}(a.Component);var L=function(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(""),l=Object(u.a)(c,2),m=l[0],f=l[1],v=Object(a.useState)("common"),d=Object(u.a)(v,2),b=d[0],g=d[1],p=Object(a.useState)(""),h=Object(u.a)(p,2),w=h[0],y=h[1],N=Object(a.useState)(""),L=Object(u.a)(N,2),A=L[0],I=L[1],U=Object(a.useState)(""),W=Object(u.a)(U,2),B=W[0],P=W[1],T=Object(a.useState)(""),D=Object(u.a)(T,2),J=D[0],M=D[1],Y=Object(a.useState)(null),F=Object(u.a)(Y,2),H=F[0],z=F[1],V=Object(a.useState)(null),$=Object(u.a)(V,2),q=$[0],G=$[1],K=Object(a.useState)(!1),Q=Object(u.a)(K,2),X=Q[0],Z=Q[1],_=Object(a.useState)(""),ee=Object(u.a)(_,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(""),re=Object(u.a)(ae,2),oe=re[0],ce=re[1];Object(a.useEffect)((function(){E.getAll().then((function(e){o(e)}))}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBirdieUser");if(e){var t=JSON.parse(e);z(t),E.setToken(t.token)}}),[]);var le=function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,O.login({username:B,password:J});case 4:n=e.sent,window.localStorage.setItem("loggedBirdieUser",JSON.stringify(n)),E.setToken(n.token),z(n),P(""),M(""),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),G("wrong credentials"),setTimeout((function(){G(null)}),5e3);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),ie=r.a.createRef(),se={onSubmit:function(e){e.preventDefault(),ie.current.toggleVisibility();var t={name:m,scientificName:w,note:A,rarity:b};E.create(t).then((function(e){o([e].concat(n)),f(""),y(""),g("common"),I("")})).catch((function(e){G("Error")}))},newName:m,handleNewNameChange:function(e){f(e.target.value)},newRarity:b,handleNewRarityChange:function(e){g(e.target.value)},newScientificName:w,handleNewScientificNameChange:function(e){y(e.target.value)},newNote:A,handleNewNoteChange:function(e){I(e.target.value)}};return r.a.createElement("div",{className:"page"},r.a.createElement("div",{className:"header"},r.a.createElement("h1",{className:"title"},"Birdie"),r.a.createElement("div",{className:"login"},null===H?function(){var e={display:X?"none":""},t={display:X?"":"none"};return r.a.createElement("div",null,r.a.createElement("div",{style:e},r.a.createElement("button",{onClick:function(){return Z(!0)}},"Login")),r.a.createElement("div",{style:t,className:"login-form"},r.a.createElement(C,{username:B,password:J,handleUsernameChange:function(e){var t=e.target;return P(t.value)},handlePasswordChange:function(e){var t=e.target;return M(t.value)},handleSubmit:le}),r.a.createElement("button",{onClick:function(){return Z(!1)}},"Cancel")))}():r.a.createElement("div",null,H.name))),r.a.createElement("div",{className:"top-menu"},r.a.createElement("div",{className:"create-observations"},null===H?"Please login to add observations":r.a.createElement(r.a.Fragment,null,r.a.createElement(x,{buttonLabel:"New observation",ref:ie},r.a.createElement(k,se)))),r.a.createElement("div",{className:"error-message"},r.a.createElement(S,{message:q}))),r.a.createElement("div",{className:"search"},r.a.createElement("label",null,"Search"),r.a.createElement("input",{value:te,onChange:function(e){ne(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("label",null,"Rarity"),r.a.createElement("select",{value:oe,onChange:function(e){ce(e.target.value)}},r.a.createElement("option",{value:""},"All"),r.a.createElement("option",{value:"common"},"Common"),r.a.createElement("option",{value:"rare"},"Rare"),r.a.createElement("option",{value:"extremely rare"},"Extremely rare"))),r.a.createElement("div",{className:"observations-rows"},n.filter((function(e){return function(e){return e.name.toLowerCase().includes(te.toLowerCase())||e.scientificName.toLowerCase().includes(te.toLowerCase())||e.note.toLowerCase().includes(te.toLowerCase())}(e)})).filter((function(e){return function(e){return""===oe||e.rarity===oe}(e)})).map((function(e){return r.a.createElement(R,{key:e.id,observation:e})}))),r.a.createElement(j,null))},A=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function I(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(r.a.createElement(L,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");A?(!function(e,t){fetch(e).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):I(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):I(t,e)}))}}()}},[[22,1,2]]]);
//# sourceMappingURL=main.1675b013.chunk.js.map